/*!
 * JSQR - JavaScript Quick Response Code Encoder Library v1.0.2
 * http://www.jsqr.de
 *
 * Copyright 2011-2015, Jens Duttke
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.jsqr.de/license
 *
 * Date: 2015-11-13
 */(function(A,Et){var $=function(o,n){if(typeof o<"u"){if(!L(this.DATA_TYPE,o))throw new TypeError("Unsupported dataType")}else o=this.DATA_TYPE.DEFAULT;try{Object.defineProperty(this,"dataType",{configurable:!1,writeable:!0,get:function(){return o},set:function(u){if(L(this.DATA_TYPE,u))o=u;else throw new TypeError("Unsupported dataType")}})}catch{this.dataType=o}typeof n=="object"?this.data=ot(n):this.data=n};$.prototype.DATA_TYPE={DEFAULT:0,TEXT:0,URL:1,BOOKMARK:2,CALL:3,SMS:4,EMAIL:5,VCARD:6,MECARD:7,VEVENT:8,GOOGLE_MAPS:9,BING_MAPS:10,GEO:11,ITUNES:12,ITUNES_REVIEW:13,ANDROID_MARKET:14,FACEBOOK_USER_PROFILE:15,FOURSQUARE:16,TWEET_FETCH:17,TWEET:18,BLACKBERRY_MESSENGER_USER:19,ANDROID_WIFI:20,WIKIPEDIA:21,YOUTUBE_USER:22,YOUTUBE_VIDEO:23,BITCOIN:24},$.prototype.toString=function(){var o=this,n,u,t;switch(this.dataType){case this.DATA_TYPE.DEFAULT:case this.DATA_TYPE.TEXT:return a("data","string","number","object"),typeof this.data=="object"?(a("data.text","string","number"),s("data.text"),e("text")):(s("data"),e());case this.DATA_TYPE.URL:return a("data","string","object"),typeof this.data=="object"?(a("data.url","string"),s("data.url"),(/^[a-zA-Z]+:\/\//.test(e("url"))?"":"http://")+e("url")):(s("data"),(/^[a-zA-Z]+:\/\//.test(e())?"":"http://")+e());case this.DATA_TYPE.BOOKMARK:return a("data","object"),a("data.title","string","number"),a("data.url","string"),s("data.title","data.url"),"MEBKM:TITLE:"+e("title")+";URL:"+(/^[a-zA-Z]+:\/\//.test(e("url"))?"":"http://")+e("url");case this.DATA_TYPE.CALL:return a("data","string","number","object"),typeof this.data=="object"?(a("data.phoneNumber","string","number"),s("data.phoneNumber"),"TEL:"+e("phoneNumber")):(s("data"),"TEL:"+e());case this.DATA_TYPE.SMS:return a("data","object"),a("data.phoneNumber","string","number"),a("data.message","string","number"),s("data.phoneNumber"),"SMSTO:"+e("phoneNumber")+":"+e("message");case this.DATA_TYPE.EMAIL:return a("data","object"),a("data.recipient","string"),a("data.subject","string"),a("data.body","string"),s("data.recipient"),"SMTP:"+e("recipient").replace(":","")+":"+e("subject").replace(/:/g,"\\:")+":"+e("body");case this.DATA_TYPE.VCARD:switch(a("data","object"),a("data.version","string","number"),a("data.type","string"),a("data.firstName","string","number"),a("data.middleName","string","number"),a("data.lastName","string","number"),a("data.organization","string","number"),a("data.title","string","number"),a("data.mobilePhone","string","number"),a("data.work","object"),a("data.work.street","string","number"),a("data.work.city","string"),a("data.work.zip","string","number"),a("data.work.state","string"),a("data.work.country","string"),a("data.work.phone","string","number"),a("data.work.fax","string","number"),a("data.work.eMail","string"),a("data.work.url","string"),a("data.home","object"),a("data.home.street","string","number"),a("data.home.city","string","number"),a("data.home.zip","string","number"),a("data.home.state","string","number"),a("data.home.country","string"),a("data.home.phone","string","number"),a("data.home.eMail","string"),a("data.home.url","string"),a("data.birthday",Date,null),s("data.version","data.type"),t={"\\":"\\\\",";":"\\;",",":"\\,","\n":"\\n"},n=[],parseFloat(e("version"))){case 2.1:n[0]="2.1";break;case 3:n[0]="3.0";break;default:throw new Error("Unsupported VCARD.version ("+e("version")+")")}switch(e("type").toLowerCase()){case"person":n[1]=(e("firstName").length>0||e("middleName").length>0||e("lastName").length>0?"FN:"+(r(e("firstName"),t)+" "+r(e("middleName"),t)+" "+r(e("lastName"),t)).replace(/\s{2,}/g," ").replace(/^\s+|\s+$/g,"")+`
`:"")+(e("organization").length>0?"ORG:"+r(e("organization"),t)+`
`:"");break;case"company":n[1]=(e("organization").length>0?"ORG:"+r(e("organization"),t)+`
`:"")+(e("organization").length>0?"FN:"+r(e("organization"),t)+`
`:"")+`X-ABShowAs:COMPANY
`;break;default:throw new Error("Unsupported VCARD.type ("+e("type")+")")}return`BEGIN:VCARD
VERSION:`+n[0]+`
`+(e("lastName").length>0||e("firstName").length>0||e("middleName").length>0?"N:"+r(e("lastName"),t)+";"+r(e("firstName"),t)+";"+r(e("middleName"),t)+`;;
`:"")+n[1]+(e("title").length>0?"TITLE:"+r(e("title"),t)+`
`:"")+(i("work")&&e("work.eMail").length>0?"EMAIL;"+(n[0]==="3.0"?"type=INTERNET;type=":"INTERNET;")+"WORK:"+r(e("work.eMail"),t)+`
`:"")+(i("home")&&e("home.eMail").length>0?"EMAIL;"+(n[0]==="3.0"?"type=INTERNET;type=":"INTERNET;")+"HOME:"+r(e("home.eMail"),t)+`
`:"")+(e("mobilePhone").length>0?"TEL;"+(n[0]==="3.0"?"type=":"")+"CELL:"+r(e("mobilePhone"),t)+`
`:"")+(i("work")&&e("work.phone").length>0?"TEL;"+(n[0]==="3.0"?"type=":"")+"WORK:"+r(e("work.phone"),t)+`
`:"")+(i("home")&&e("home.phone").length>0?"TEL;"+(n[0]==="3.0"?"type=":"")+"HOME:"+r(e("home.phone"),t)+`
`:"")+(i("work")&&e("work.fax").length>0?"TEL;"+(n[0]==="3.0"?"type=WORK,":"WORK;")+"FAX:"+r(e("work.fax"),t)+`
`:"")+(i("work")&&(e("work.street").length>0||e("work.city").length>0||e("work.state").length>0||e("work.zip").length>0||e("work.country").length>0)?"ADR;"+(n[0]==="3.0"?"type=":"")+"WORK:;;"+r(e("work.street"),t)+";"+r(e("work.city"),t)+";"+r(e("work.state"),t)+";"+r(e("work.zip"),t)+";"+r(e("work.country"),t)+`
`:"")+(i("home")&&(e("home.street").length>0||e("home.city").length>0||e("home.state").length>0||e("home.zip").length>0||e("home.country").length>0)?"ADR;"+(n[0]==="3.0"?"type=":"")+"HOME:;;"+r(e("home.street"),t)+";"+r(e("home.city"),t)+";"+r(e("home.state"),t)+";"+r(e("home.zip"),t)+";"+r(e("home.country"),t)+`
`:"")+(i("birthday")&&i("birthday")!==null?"BDAY;value=date:"+i("birthday").getFullYear()+("0"+(i("birthday").getMonth()+1)).substr(-2)+("0"+i("birthday").getDate()).substr(-2)+";":"")+(i("work")&&e("work.url").length>0?"URL;"+(n[0]==="3.0"?"type=":"")+"WORK:"+r(e("work.url"),t)+`
`:"")+(i("home")&&e("home.url").length>0?"URL;"+(n[0]==="3.0"?"type=":"")+"HOME:"+r(e("home.url"),t)+`
`:"")+"END:VCARD";case this.DATA_TYPE.MECARD:return a("data","object"),a("data.firstName","string","number"),a("data.lastName","string","number"),a("data.eMail","string"),a("data.phoneNumber","string","number"),a("data.videoCall","string","number"),a("data.birthday",Date,null),a("data.poBox","string","number"),a("data.room","string","number"),a("data.street","string","number"),a("data.city","string"),a("data.state","string"),a("data.zip","string","number"),a("data.country","string"),a("data.url","string","number"),a("data.memo","string","number"),t={"\\":"\\\\",":":"\\:",";":"\\;",",":"\\,"},"MECARD:"+(e("lastName").length>0||e("firstName")>0?"N:"+r(e("lastName"),t)+(e("firstName").length>0?","+r(e("firstName"),t):"")+";":"")+(e("phoneNumber").length>0?"TEL:"+r(e("phoneNumber"),t)+";":"")+(e("videoCall").length>0?"TEL-AV:"+r(e("videoCall"),t)+";":"")+(e("eMail").length>0?"EMAIL:"+r(e("eMail"),t)+";":"")+(e("url").length>0?"URL:"+r(e("url"),t)+";":"")+(e("memo").length>0?"NOTE:"+r(e("memo"),t)+";":"")+(i("birthday")&&i("birthday")!==null?"BDAY:"+i("birthday").getFullYear()+("0"+(i("birthday").getMonth()+1)).substr(-2)+("0"+i("birthday").getDate()).substr(-2)+";":"")+(e("street").length>0?"ADR:"+r(e("poBox"),t)+","+r(e("room"),t)+","+r(e("street"),t)+","+r(e("city"),t)+","+r(e("state"),t)+","+r(e("zip"),t)+","+r(e("country"),t)+";":"")+";";case this.DATA_TYPE.VEVENT:if(a("data","object"),a("data.format","string"),a("data.summary","string","number"),a("data.description","string","number"),a("data.locationName","string","number"),a("data.fullDay","boolean"),a("data.startDate",Date),a("data.endDate",Date),s("data.format","data.summary","data.fullDay","data.startDate","data.endDate"),Date.parse(e("startDate"))>Date.parse(e("endDate")))throw new RangeError("VEVENT.startDate must be older than VEVENT.endDate");switch(t={"\\":"\\\\",";":"\\;",",":"\\,","\n":"\\n"},n=`BEGIN:VEVENT
SUMMARY:`+r(e("summary"),t)+`
`+(e("description").length>0?"DESCRIPTION:"+r(e("description"),t)+`
`:"")+(e("locationName").length>0?"LOCATION:"+r(e("locationName"),t)+`
`:"")+"DTSTART:"+i("startDate").getFullYear()+("0"+(i("startDate").getMonth()+1)).substr(-2)+("0"+i("startDate").getDate()).substr(-2)+(i("fullDay")?"":"T"+("0"+i("startDate").getHours()).substr(-2)+("0"+i("startDate").getMinutes()).substr(-2)+("0"+i("startDate").getSeconds()).substr(-2))+`
DTEND:`+i("endDate").getFullYear()+("0"+(i("endDate").getMonth()+1)).substr(-2)+("0"+i("endDate").getDate()).substr(-2)+(i("fullDay")?"":"T"+("0"+i("endDate").getHours()).substr(-2)+("0"+i("endDate").getMinutes()).substr(-2)+("0"+i("endDate").getSeconds()).substr(-2))+`
END:VEVENT`,e("format").toLowerCase()){case"icalendar":return`BEGIN:VCALENDAR
VERSION:2.0
`+n+`
END:VCALENDAR`;case"zxing":return n;default:throw new Error("Unsupported VEVENT.format ("+e("format")+")")}case this.DATA_TYPE.GOOGLE_MAPS:return a("data","object"),a("data.locationName","string"),a("data.longitude","string","number"),a("data.latitude","string","number"),s("data.longitude","data.latitude"),"http://maps.google.com/maps?f=q&q="+e("latitude")+"%2C"+e("longitude")+"+%28"+encodeURIComponent(e("locationName"))+"%29";case this.DATA_TYPE.BING_MAPS:return a("data","object"),a("data.longitude","string","number"),a("data.latitude","string","number"),s("data.longitude","data.latitude"),"http://www.bing.com/maps/?v=2&cp="+e("latitude")+"~"+e("longitude")+"&lvl=16&dir=0&sty=r";case this.DATA_TYPE.GEO:return a("data","object"),a("data.longitude","string","number"),a("data.latitude","string","number"),s("data.longitude","data.latitude"),"GEO:"+e("latitude")+","+e("longitude");case this.DATA_TYPE.ITUNES:if(a("data","string","number","object"),typeof this.data=="object"?(a("data.appId","string","number"),s("data.appId"),n=e("appId")):(s("data"),n=e()),!/\d+$/.test(n))throw new Error("Invalid ITUNES.appId. The id must be numeric");return"http://itunes.apple.com/app/id"+/\d+$/.exec(n)[0];case this.DATA_TYPE.ITUNES_REVIEW:if(a("data","string","number","object"),typeof this.data=="object"?(a("data.appId","string","number"),s("data.appId"),n=e("appId")):(s("data"),n=e()),!/\d+$/.test(n))throw new Error("Invalid ITUNES.appId. The id must be numeric");return"itms-apps://ax.itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&id="+/\d+$/.exec(n)[0];case this.DATA_TYPE.ANDROID_MARKET:switch(a("data","object"),a("data.searchType","string"),a("data.linkType","string"),a("data.search","string","number"),s("data.searchType","data.linkType","data.search"),e("linkType").toLowerCase()){case"market":n="market://";break;case"website":n="http://market.android.com/";break;default:throw new Error("Unsupported ANDROID_MARKET.linkType ("+e("linkType")+")")}switch(e("searchType").toLowerCase()){case"raw":return n+"search?q="+encodeURIComponent(e("search"));case"package":return n+"search?q=pname%3A"+encodeURIComponent(e("search"));case"publisher":return n+"search?q=pub%3A"+encodeURIComponent(e("search"));case"details":return n+"details?id="+encodeURIComponent(e("search"));default:throw new Error("Unsupported ANDROID_MARKET.searchType ("+e("searchType")+")")}case this.DATA_TYPE.FACEBOOK_USER_PROFILE:if(a("data","string","number","object"),typeof this.data=="object"?(a("data.profileId","string","number"),s("data.profileId"),n=e("profileId")):(s("data"),n=e()),/^\d{15}$/.test(n))return"fb://profile/"+n;if(/(\/profile\/|(\?|&)id=)(\d{15})(%26|&|$)/.test(n))return"fb://profile/"+/(\/profile\/|(\?|&)id=)(\d{15})(%26|&|$)/.exec(n)[3];throw new Error("Invalid FACEBOOK_USER_PROFILE.videoId. The id must be numeric, 15 characters in length");case this.DATA_TYPE.FOURSQUARE:if(a("data","string","number","object"),typeof this.data=="object"?(a("data.venueId","string","number"),s("data.venueId"),n=e("venueId")):(s("data"),n=e()),!/\d+$/.test(n))throw new Error("Invalid FOURSQUARE.venueId. The id must be numeric");return"http://foursquare.com/venue/"+/\d+$/.exec(n)[0];case this.DATA_TYPE.WIKIPEDIA:return a("data","string","number","object"),typeof this.data=="object"?(a("data.url","string","number"),s("data.url"),n=e("url")):(s("data"),n=e()),t={" ":"_"},u=/\/\/([a-z\-]*)\.?wikipedia.org\/wiki\/(.*)/i.exec(n),u===null||u.length!==3?"http://qrwp.org/"+r(n,t):"http://"+(u[1].length>0?u[1]+".":"")+"qrwp.org/"+r(u[2],t);case this.DATA_TYPE.YOUTUBE_USER:return a("data","string","number","object"),typeof this.data=="object"?(a("data.userName","string","number"),s("data.userName"),n=e("userName")):(s("data"),n=e()),"http://youtube.com/user/"+n;case this.DATA_TYPE.YOUTUBE_VIDEO:if(a("data","string","number","object"),typeof this.data=="object"?(a("data.videoId","string","number"),s("data.videoId"),n=e("videoId")):(s("data"),n=e()),/^[-_A-Za-z0-9]+$/.test(n))return"youtube://"+n;if(/(youtu.be\/|(\?|&)v=|\/v\/)([-_A-Za-z0-9]+)(%26|&|$)/.test(n))return"youtube://"+/(youtu.be\/|(\?|&)v=|\/v\/)([-_A-Za-z0-9]+)(%26|&|$)/.exec(n)[3];throw new Error("Invalid YOUTUBE.videoId. The id must be alphanumeric");case this.DATA_TYPE.TWEET_FETCH:throw new Error("DATA_TYPE.TWEET_FETCH is currently unsupported");case this.DATA_TYPE.TWEET:return a("data","string","number","object"),typeof this.data=="object"?(a("data.text","string","number"),s("data.text"),"http://twitter.com/home?status="+encodeURIComponent(e("text"))):(s("data"),"http://twitter.com/home?status="+encodeURIComponent(e()));case this.DATA_TYPE.BLACKBERRY_MESSENGER_USER:if(a("data","object"),a("data.firstName","string"),a("data.lastName","string"),a("data.bbmPin","string"),s("data.bbmPin"),!/^[A-Za-z0-9]{8}$/.test(e("bbmPin")))throw new Error("Invalid BLACKBERRY_MESSENGER_USER.bbmPin. The pin must be alphanumeric, eight characters in length");return"bbm:"+e("bbmPin")+"00000000"+e("firstName")+" "+e("lastName");case this.DATA_TYPE.ANDROID_WIFI:return a("data","object"),a("data.ssid","string"),a("data.password","string","number"),a("data.networkType","string"),s("data.ssid","data.networkType"),"WIFI:S:"+e("ssid")+";T:"+e("networkType")+(e("password").length>0?";P:"+e("password"):"")+";;";case this.DATA_TYPE.BITCOIN:return a("data","string","object"),typeof this.data=="object"?(a("data.hash","string"),s("data.hash"),(/^bitcoin:/.test(e("hash"))?"":"bitcoin:")+e("hash")):(s("data"),(/^bitcoin:/.test(e())?"":"bitcoin:")+e());default:throw new TypeError("Unsupported dataType")}function i(l){var d=o.data;if(typeof l=="string"){var h=l.split("."),p;for(p=0;p<h.length;p++)d=d[h[p]]}return d}function e(l){var d=i(l);return typeof d>"u"?"":d.toString()}function r(l,d){for(var h in d)d.hasOwnProperty(h)&&(l=l.replace(h,d[h],"g"));return l}function a(){var l=arguments[0].split("."),d=o,h;for(h=0;h<l.length;h++)d=d[l[h]];for(h=1;h<arguments.length;h++){if(typeof d=="object"&&typeof arguments[h]=="function"&&d!==null&&d.constructor===arguments[h]||d===null&&arguments[h]===null||typeof d===arguments[h])return!0;typeof arguments[h]=="function"&&(arguments[h]=arguments[h].name)}throw typeof d>"u"?new TypeError(arguments[0]+" is undefined"):new TypeError("Unexcepted type ("+typeof d+") of "+arguments[0]+" ("+[].slice.call(arguments,1).join("|")+")")}function s(){var l,d,h,p;for(h=0;h<arguments.length;h++){for(l=arguments[h].split("."),d=o,p=0;p<l.length;p++)d=d[l[p]];if(typeof d=="string"&&d.length===0)throw new Error(arguments[h]+" cannot be empty")}}};var v=function(o,n,u){if(typeof o=="object"&&typeof n>"u"&&typeof u>"u"&&(u=o.errorCorrection,n=o.version,o=o.encodeMode),typeof o<"u"){if(!L(this.ENCODE_MODE,o))throw new TypeError("Unsupported encodeMode")}else o=this.ENCODE_MODE.UTF8;try{Object.defineProperty(this,"encodeMode",{configurable:!1,writeable:!0,get:function(){return o},set:function(t){if(L(this.ENCODE_MODE,t))o=t;else throw new TypeError("Unsupported encodeMode")}})}catch{this.encodeMode=o}if(typeof n<"u"){if(typeof n!="number")throw new TypeError("Invalid version type");if(n<-40||n>40)throw new RangeError("Invalid version value")}else n=this.DEFAULT;try{Object.defineProperty(this,"version",{configurable:!1,writeable:!0,get:function(){return n},set:function(t){if(typeof t!="number")throw new TypeError("Invalid version type");if(t<-40||t>40)throw new RangeError("Invalid version value");n=t}})}catch{this.version=n}if(typeof u<"u"){if(!L(this.ERROR_CORRECTION,u))throw new TypeError("Invalid errorCorrection")}else u=this.ERROR_CORRECTION.M;try{Object.defineProperty(this,"errorCorrection",{configurable:!1,writeable:!0,get:function(){return u},set:function(t){if(L(this.ERROR_CORRECTION,t))u=t;else throw new TypeError("Invalid errorCorrection")}})}catch{this.errorCorrection=u}};v.prototype.ENCODE_MODE={NUMERIC:1,ALPHA_NUMERIC:2,BYTE:4,UTF8:20,UTF8_SIGNATURE:36,STRUCTURED_APPEND:3,FNC1_POS1:5,ECI:7,KANJI:8,FNC1_POS2:9},v.prototype.ERROR_CORRECTION={L:1,M:0,Q:3,H:2},v.prototype.DEFAULT=0,v.prototype.getVersion=function(o){return this.version>0?this.version:Q(J(o,this),this,!0)},v.prototype.getMinVersion=function(o){var n=new v(this.encodeMode,this.DEFAULT,this.errorCorrection);return Q(J(o,n),n,!0)};var lt=function(o,n){var u,t,i=this;for(u=Q(J(o,n),n),t=0;t<u.length;t++)this[t]=u[t];try{Object.defineProperty(this,"scale",{configurable:!1,writeable:!0,get:function(){return e},set:function(l){if(typeof l!="number")throw new TypeError("Invalid scale type");if(l<=0||l>256)throw new RangeError("Scale value out of range");e=l}});var e=4}catch{this.scale=4}try{Object.defineProperty(this,"margin",{configurable:!1,writeable:!0,get:function(){return r},set:function(l){if(typeof l!="number")throw new TypeError("Invalid margin type");if(l<0||l>256)throw new RangeError("Margin value out of range");r=l}});var r=4}catch{this.margin=4}try{Object.defineProperty(this,"color1",{configurable:!1,writeable:!0,get:function(){return a},set:function(l){if(typeof l=="string")a=l;else throw new TypeError("Invalid color1 type")}});var a="rgb(0,0,0)"}catch{this.color1="rgb(0,0,0)"}try{Object.defineProperty(this,"color0",{configurable:!1,writeable:!0,get:function(){return s},set:function(l){if(typeof l=="string")s=l;else throw new TypeError("Invalid color2 type")}});var s="none"}catch{this.color0="none"}try{Object.defineProperty(this,"length",{configurable:!1,writeable:!1,get:function(){return u.length}})}catch{this.length=new function(){this.toString=function(){return u.length}}}try{Object.defineProperty(this,"width",{configurable:!1,writeable:!1,get:function(){return u.length+(i.margin<<1)}})}catch{this.width=new function(){this.toString=function(){return u.length+(i.margin<<1)}}}try{Object.defineProperty(this,"pixelWidth",{configurable:!1,writeable:!1,get:function(){return(u.length+(i.margin<<1))*i.scale}})}catch{this.pixelWidth=new function(){this.toString=function(){return(u.length+(i.margin<<1))*i.scale}}}this.draw=function(l,d,h){var p=l.getContext("2d"),c=this.scale,I=this.margin,O,b;for(b=0;b<u.length;b++)for(O=0;O<u[b].length;O++)u[b][O]&&p.fillRect(d+(O+I)*c,h+(b+I)*c,c,c)},this.drawHTML=function(l,d,h){d=d||"div";var p=this.scale,c=this.margin,I=this.color1,O='<div style="position:relative; background:'+this.color2+'">',b,x,_;for(x=0;x<u.length;x++)for(b=0;b<u.length;b=b+_)if(_=1,u[x][b]===1){for(;b+_<u.length&&u[x][b+_]===1;)_++;h?O+="<"+d+' style="width:'+_*p+"px; height:"+p+"px; left:"+(b+c)*p+"px; top:"+(x+c)*p+'px;"></'+d+">":O+="<"+d+' style="position:absolute; width:'+_*p+"px; height:"+p+"px; left:"+(b+c)*p+"px; top:"+(x+c)*p+"px; background:"+I+';"></'+d+">"}return O+=NaN,l&&typeof l.innerHTML<"u"&&(l.innerHTML=O),O},this.toDataURL=function(){},this.toSVG=function(){},this.toArray=function(){var l,d,h=U(u.length+(r<<1),0);for(d=0;d<u.length;d++)for(h[d+r]=U(u[d].length+(r<<1),0),l=0;l<u[d].length;l++)h[d+r][l+r]=u[d][l];return h},this.toString=function(){return this.toArray().toString()}},y={TOTAL_BYTES:0,ECC_BYTES:2,EC_BLOCKS:3,ALIGNMENT_PATTERN_POSITION_OFFSET:4,VERSION_PATTERN:5},m=[null,[26,0,[10,7,17,13],[[1,0],[1,0],[1,0],[1,0]],0,null],[44,7,[16,10,28,22],[[1,0],[1,0],[1,0],[1,0]],12,null],[70,7,[26,15,44,36],[[1,0],[1,0],[2,0],[2,0]],16,null],[100,7,[36,20,64,52],[[2,0],[1,0],[4,0],[2,0]],20,null],[134,7,[48,26,88,72],[[2,0],[1,0],[2,2],[2,2]],24,null],[172,7,[64,36,112,96],[[4,0],[2,0],[4,0],[4,0]],28,null],[196,0,[72,40,130,108],[[4,0],[2,0],[4,1],[2,4]],16,31892],[242,0,[88,48,156,132],[[2,2],[2,0],[4,2],[4,2]],18,34236],[292,0,[110,60,192,160],[[3,2],[2,0],[4,4],[4,4]],20,39577],[346,0,[130,72,224,192],[[4,1],[2,2],[6,2],[6,2]],22,42195],[404,0,[150,80,264,224],[[1,4],[4,0],[3,8],[4,4]],24,48118],[466,0,[176,96,308,260],[[6,2],[2,2],[7,4],[4,6]],26,51042],[532,0,[198,104,352,288],[[8,1],[4,0],[12,4],[8,4]],28,55367],[581,3,[216,120,384,320],[[4,5],[3,1],[11,5],[11,5]],20,58893],[655,3,[240,132,432,360],[[5,5],[5,1],[11,7],[5,7]],22,63784],[733,3,[280,144,480,408],[[7,3],[5,1],[3,13],[15,2]],24,68472],[815,3,[308,168,532,448],[[10,1],[1,5],[2,17],[1,15]],24,70749],[901,3,[338,180,588,504],[[9,4],[5,1],[2,19],[17,1]],26,76311],[991,3,[364,196,650,546],[[3,11],[3,4],[9,16],[17,4]],28,79154],[1085,3,[416,224,700,600],[[3,13],[3,5],[15,10],[15,5]],28,84390],[1156,4,[442,224,750,644],[[17,0],[4,4],[19,6],[17,6]],22,87683],[1258,4,[476,252,816,690],[[17,0],[2,7],[34,0],[7,16]],24,92361],[1364,4,[504,270,900,750],[[4,14],[4,5],[16,14],[11,14]],24,96236],[1474,4,[560,300,960,810],[[6,14],[6,4],[30,2],[11,16]],26,102084],[1588,4,[588,312,1050,870],[[8,13],[8,4],[22,13],[7,22]],26,102881],[1706,4,[644,336,1110,952],[[19,4],[10,2],[33,4],[28,6]],28,110507],[1828,4,[700,360,1200,1020],[[22,3],[8,4],[12,28],[8,26]],28,110734],[1921,3,[728,390,1260,1050],[[3,23],[3,10],[11,31],[4,31]],24,117786],[2051,3,[784,420,1350,1140],[[21,7],[7,7],[19,26],[1,37]],24,119615],[2185,3,[812,450,1440,1200],[[19,10],[5,10],[23,25],[15,25]],26,126325],[2323,3,[868,480,1530,1290],[[2,29],[13,3],[23,28],[42,1]],26,127568],[2465,3,[924,510,1620,1350],[[10,23],[17,0],[19,35],[10,35]],26,133589],[2611,3,[980,540,1710,1440],[[14,21],[17,1],[11,46],[29,19]],28,136944],[2761,3,[1036,570,1800,1530],[[14,23],[13,6],[59,1],[44,7]],28,141498],[2876,0,[1064,570,1890,1590],[[12,26],[12,7],[22,41],[39,14]],24,145311],[3034,0,[1120,600,1980,1680],[[6,34],[6,14],[2,64],[46,10]],26,150283],[3196,0,[1204,630,2100,1770],[[29,14],[17,4],[24,46],[49,10]],26,152622],[3362,0,[1260,660,2220,1860],[[13,32],[4,18],[42,32],[48,14]],26,158308],[3532,0,[1316,720,2310,1950],[[40,7],[20,4],[10,67],[43,22]],28,161089],[3706,0,[1372,750,2430,2040],[[18,31],[19,6],[20,61],[34,34]],28,167017]],dt=[[21522,20773,24188,23371,17913,16590,20375,19104],[30660,29427,32170,30877,26159,25368,27713,26998],[5769,5054,7399,6608,1890,597,3340,2107],[13663,12392,16177,14854,9396,8579,11994,11245]],q=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,1,1,1,0,1],[1,0,1,1,1,0,1],[1,0,1,1,1,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],ct=[[1,1,1,1,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,1,1,1,1]],Z=[function(o,n){return(n+o)%2===0},function(o,n){return n%2===0},function(o,n){return o%3===0},function(o,n){return(n+o)%3===0},function(o,n){return(Math.floor(n/2)+Math.floor(o/3))%2===0},function(o,n){return n*o%2+n*o%3===0},function(o,n){return(n*o%2+n*o%3)%2===0},function(o,n){return(n*o%3+(n+o)%2)%2===0}],T={FINDER:2,SEPARATOR:4,TIMING:8,ALIGNMENT:16,VERSION:32,FORMAT:64,DATA:128};function Q(o,n,u){var t,i,e,r,a,s=n.version,l=n.errorCorrection,d=new Array(m[m.length-1][y.TOTAL_BYTES]*8),h=0,p,c;switch(n.encodeMode){case n.ENCODE_MODE.NUMERIC:var I=0;for(t=0;t<o.length;t++)if(o[t]>=48&&o[t]<=57)I=I*10+(o[t]-48),t%3===2&&(h=N(d,h,D(I,10)),I=0);else throw new TypeError("Invalid data format");switch(t%3){case 1:h=N(d,h,D(I,4));break;case 2:h=N(d,h,D(I,7));break}if(s>0)s>=1&&s<=9?p=10:s>=10&&s<=26?p=12:s>=27&&s<=40&&(p=14);else{if(c=C(h+4+10,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=1&&c<=9)p=10;else if(c=C(h+4+12,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=10&&c<=26)p=12;else if(c=C(h+4+14,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=27&&c<=40)p=14;else throw new RangeError("Bug in version detection");else throw new RangeError("Too much data");else throw new RangeError("Too much data");else throw new RangeError("Too much data");s=c}break;case n.ENCODE_MODE.ALPHA_NUMERIC:var O=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,32,36,37,42,43,45,46,47,58],b,x;for(t=0;t<o.length-1;t+=2){if(b=X((o[t]&96)===96?o[t]&95:o[t],O),x=X((o[t+1]&96)===96?o[t+1]&95:o[t+1],O),b===-1||x===-1)throw new Error("Character not supported in ALPHA_NUMERIC encoding mode");h=N(d,h,D(b*45+x,11))}if(t===o.length-1){if(b=X((o[t]&96)===96?o[t]&95:o[t],O),b===-1)throw new Error("Character not supported in ALPHA_NUMERIC encoding mode");h=N(d,h,D(b,6))}if(s>0)s>=1&&s<=9?p=9:s>=10&&s<=26?p=11:s>=27&&s<=40&&(p=13);else{if(c=C(h+4+9,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=1&&c<=9)p=9;else if(c=C(h+4+11,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=10&&c<=26)p=11;else if(c=C(h+4+13,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=27&&c<=40)p=13;else throw new RangeError("Bug in version detection");else throw new RangeError("Too much data");else throw new RangeError("Too much data");else throw new RangeError("Too much data");s=c}break;case n.ENCODE_MODE.BYTE:case n.ENCODE_MODE.UTF8:case n.ENCODE_MODE.UTF8_SIGNATURE:for(t=0;t<o.length;t++)h=N(d,h,D(o[t],8));if(s>0)s>=0&&s<=9?p=8:s>=10&&s<=40&&(p=16);else{if(c=C(h+4+8,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=1&&c<=9)p=8;else if(c=C(h+4+16,l),c>0)if(c<Math.abs(s)&&(c=Math.abs(s)),c>=10&&c<=40)p=16;else throw new RangeError("Bug in version detection");else throw new RangeError("Too much data");else throw new RangeError("Too much data");s=c}break;case n.ENCODE_MODE.KANJI:throw new Error('Encoding mode "KANJI" not supported yet');default:throw new Error("Unsupported encoding mode")}if(u)return s;d=D(n.encodeMode&15,4).concat(D(o.length,p)).concat(d),h+=4+p;var _=m[s][y.TOTAL_BYTES]-m[s][y.ECC_BYTES][l]<<3;if(h>_)throw new RangeError("Too much data for the selected version");var tt=_-h;for(tt>4&&(tt=4),h=N(d,h,U(tt,0)),h=N(d,h,U((8-h%8)%8,0)),t=0,a=_-h>>>3;t<a;t++)h=N(d,h,t&1?[0,0,0,1,0,0,0,1]:[1,1,1,0,1,1,0,0]);var et=Math.floor((m[s][y.TOTAL_BYTES]-m[s][y.ECC_BYTES][l])/(m[s][y.EC_BLOCKS][l][0]+m[s][y.EC_BLOCKS][l][1])),rt=Math.floor(m[s][y.ECC_BYTES][l]/(m[s][y.EC_BLOCKS][l][0]+m[s][y.EC_BLOCKS][l][1])),P=[],k=[];for(t=0,a=m[s][y.EC_BLOCKS][l][0];t<a;t++){for(k=[],i=0;i<et;i++)k.push(at(d.splice(0,8)));P.push(k)}for(t=0,a=m[s][y.EC_BLOCKS][l][1];t<a;t++){for(k=[],i=0;i<=et;i++)k.push(at(d.splice(0,8)));P.push(k)}var V=[],B=[];for(i=1,t=0;t<255;t++)V.push(i),B[i]=t,i<<=1,i>255&&(i=285^i);var M=[1];for(t=0,a=rt;t<a;t++){for(M[t+1]=1,i=t;i>0;i--)M[i]>0?M[i]=M[i-1]^V[(B[M[i]]+t)%255]:M[i]=M[i-1];M[0]=V[(B[M[0]]+t)%255]}var K=[];for(t=M.length-1;t>=0;t--)K.push(M[t]);var S=[];for(i=0;i<P.length;i++){S[i]=[].concat(P[i]).concat(U(rt,0));for(var it;S[i].length>=K.length;){for(it=S[i][0],t=0;t<K.length;t++)S[i][t]^=V[(B[K[t]]+B[it])%255];if(S[i].shift()!==0)throw new Error("Bug while generating the ECC")}}for(d=new Array(m[m.length-1][y.TOTAL_BYTES]*8),h=0,t=0;t<=et;t++)for(i=0;i<P.length;i++)t<P[i].length&&(h=N(d,h,D(P[i][t],8)));for(t=0;t<rt;t++)for(i=0;i<S.length;i++)t<S[i].length&&(h=N(d,h,D(S[i][t],8)));var E=17+(s<<2),g=new Array(E);for(t=0;t<E;t++)g[t]=U(E,0);for(j(g,0,0,q,T.FINDER),j(g,0,E-7,q,T.FINDER),j(g,E-7,0,q,T.FINDER),t=0;t<8;t++)g[t][7]=T.SEPARATOR,g[7][t]=T.SEPARATOR,g[t][E-8]=T.SEPARATOR,g[7][E-1-t]=T.SEPARATOR,g[E-1-t][7]=T.SEPARATOR,g[E-8][t]=T.SEPARATOR;for(t=8;t<E-8;t++)g[t][6]=T.TIMING|(t+1)%2,g[6][t]=T.TIMING|(t+1)%2;if(s>1){var st=m[s][y.ALIGNMENT_PATTERN_POSITION_OFFSET],ut=s*4+10;for(r=ut;;){for(e=ut;e===6&&r===6||e===6&&r===E-7||e===E-7&&r===6||j(g,e-2,r-2,ct,T.ALIGNMENT),e!==6;)e-=st,e<18&&(e=6);if(r===6)break;r-=st,r<18&&(r=6)}}if(s>=7){var G=m[s][y.VERSION_PATTERN];for(t=0;t<6;t++)for(i=0;i<3;i++)g[E-11+i][t]=T.VERSION|G&1,g[t][E-11+i]=T.VERSION|G&1,G=G>>1}for(t=0;t<8;t++)g[E-1-t][8]=T.FORMAT|0,g[8][E-1-t]=T.FORMAT|0,t!==6&&(g[8][t]=T.FORMAT|0,g[t][8]=T.FORMAT|0);g[8][8]=T.FORMAT|0,g[E-8][8]=T.FORMAT|1;var Y=-1;for(e=r=E-1,t=0;t<h;t++){g[r][e]=T.DATA|d[t];do if(e>6&&(e&1)===0||e<6&&(e&1)===1)e--;else if(Y===-1&&r===0||Y===1&&r===E-1){if(e===0){if(t<h-1)throw new RangeError("Too much data while writing the symbol");break}Y=-Y,e--,e===6&&e--}else r+=Y,e++;while(g[r][e]!==0)}var f=[],R;for(t=0;t<Z.length;t++){for(f[t]=[],r=0;r<E;r++)for(f[t][r]=[],e=0;e<E;e++)g[r][e]&T.DATA?f[t][r][e]=(g[r][e]^Z[t](e,r))&1:f[t][r][e]=g[r][e]&1;R=D(dt[l][t],15),f[t][E-1][8]=f[t][8][0]=R[0],f[t][E-2][8]=f[t][8][1]=R[1],f[t][E-3][8]=f[t][8][2]=R[2],f[t][E-4][8]=f[t][8][3]=R[3],f[t][E-5][8]=f[t][8][4]=R[4],f[t][E-6][8]=f[t][8][5]=R[5],f[t][E-7][8]=f[t][8][7]=R[6],f[t][8][E-8]=f[t][8][8]=R[7],f[t][8][E-7]=f[t][7][8]=R[8],f[t][8][E-6]=f[t][5][8]=R[9],f[t][8][E-5]=f[t][4][8]=R[10],f[t][8][E-4]=f[t][3][8]=R[11],f[t][8][E-3]=f[t][2][8]=R[12],f[t][8][E-2]=f[t][1][8]=R[13],f[t][8][E-1]=f[t][0][8]=R[14]}var ft=0,ht=4294967295,z,nt,W,F,H;for(t=0;t<Z.length;t++){for(z=nt=W=F=H=0,r=0;r<E;r++)for(e=0;e<E;e++)e>=6&&((f[t][r][e-6]&f[t][r][e-5]&f[t][r][e-4]&f[t][r][e-3]&f[t][r][e-2]&f[t][r][e-1]&f[t][r][e])===1||(f[t][r][e-6]|f[t][r][e-5]|f[t][r][e-4]|f[t][r][e-3]|f[t][r][e-2]|f[t][r][e-1]|f[t][r][e])===0)&&z++,r>=6&&((f[t][r-6][e]&f[t][r-5][e]&f[t][r-4][e]&f[t][r-3][e]&f[t][r-2][e]&f[t][r-1][e]&f[t][r][e])===1||(f[t][r-6][e]|f[t][r-5][e]|f[t][r-4][e]|f[t][r-3][e]|f[t][r-2][e]|f[t][r-1][e]|f[t][r][e])===0)&&z++,e>0&&r>0&&((f[t][r][e]&f[t][r][e-1]&f[t][r-1][e]&f[t][r-1][e-1])===1||(f[t][r][e]|f[t][r][e-1]|f[t][r-1][e]|f[t][r-1][e-1])===0)&&nt++,e>=6&&f[t][r][e-6]===1&&f[t][r][e-5]===0&&f[t][r][e-4]===1&&f[t][r][e-3]===1&&f[t][r][e-2]===1&&f[t][r][e-1]===0&&f[t][r][e]===1&&W++,r>=6&&f[t][r-6][e]===1&&f[t][r-5][e]===0&&f[t][r-4][e]===1&&f[t][r-3][e]===1&&f[t][r-2][e]===1&&f[t][r-1][e]===0&&f[t][r][e]===1&&W++,F+=f[t][r][e];F=Math.abs(100*F/(E*E)-50)/5,H=z*3+nt*3+W*40+F*10,H<ht&&(ht=H,ft=t)}for(r=0;r<E;r++)for(e=0;e<E;e++)g[r][e]&(T.DATA|T.FORMAT)?g[r][e]=f[ft][r][e]:g[r][e]=g[r][e]&1;return g}function J(o,n){var u,t,i,e,r;switch(typeof o){case"string":u=o;break;case"number":u=o.toString();break;case"object":if(o.constructor===A[w].prototype.Input)u=o.toString();else{if((Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"})(o))return o;u=new A[w].prototype.Input(o.dataType,o.data).toString()}break;default:throw new TypeError("Unsupported input parameter")}if(t=n.encodeMode===n.ENCODE_MODE.UTF8_SIGNATURE?[239,187,191]:[],n.encodeMode===n.ENCODE_MODE.UTF8_SIGNATURE||n.encodeMode===n.ENCODE_MODE.UTF8)for(i=0,r=u.length;i<r;i++)e=u.charCodeAt(i),e<128?t.push(e):e>127&&e<2048?t.push(e>>6|192,e&63|128):t.push(e>>12|224,e>>6&63|128,e&63|128);else for(i=0,r=u.length;i<r;i++)t.push(u.charCodeAt(i));return t}function C(o,n){for(var u=1;u<m.length;u++)if(o<=m[u][y.TOTAL_BYTES]-m[u][y.ECC_BYTES][n]<<3)return u;return 0}function D(o,n){var u=new Array(n);if(typeof o=="number"&&n>0&&n<=32){for(var t=n-1;t>=0;t--)u[t]=o&1,o>>=1;return u}else throw new Error("Invalid parameters in toBits().")}function at(o,n){return n=n||0,((o[n]||0)<<7)+((o[n+1]||0)<<6)+((o[n+2]||0)<<5)+((o[n+3]||0)<<4)+((o[n+4]||0)<<3)+((o[n+5]||0)<<2)+((o[n+6]||0)<<1)+(o[n+7]||0)}function U(o,n){for(var u=new Array(o),t=0;t<o;t++)u[t]=n;return u}function N(o,n,u){for(var t=0;t<u.length;t++)o[n+t]=u[t];return n+u.length}function j(o,n,u,t,i){var e,r,a,s;for(a=0,s=t.length;a<s;a++)for(e=0,r=t[a].length;e<r;e++)o[u+a][n+e]=t[a][e]^i}function X(o,n){if(typeof n.indexOf=="function")return n.indexOf(o);for(var u=0;u<n.length;u++)if(n[u]===o)return u;return-1}function L(o,n){for(var u in o)if(o.hasOwnProperty(u)&&o[u]===n)return!0;return!1}function ot(o){if(typeof o!="object")return o;var n={};for(var u in o)o.hasOwnProperty(u)&&(typeof o[u]=="object"?n[u]=ot(o[u]):n[u]=o[u]);return n}var w="JSQR";A[w]=function(){},A[w].prototype.encode=function(o,n){return new A[w].prototype.Matrix(o,n)},A[w].prototype.Input=$,A[w].prototype.DATA_TYPE=A[w].prototype.Input.prototype.DATA_TYPE,A[w].prototype.Code=v,A[w].prototype.ENCODE_MODE=A[w].prototype.Code.prototype.ENCODE_MODE,A[w].prototype.ERROR_CORRECTION=A[w].prototype.Code.prototype.ERROR_CORRECTION,A[w].prototype.DEFAULT=A[w].prototype.Code.prototype.DEFAULT,A[w].prototype.Matrix=lt})(window);
